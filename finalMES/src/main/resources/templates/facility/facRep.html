<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout}">
<head>
<meta charset="UTF-8">
<link rel="stylesheet"
	href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script
	src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.0.7/dist/umd/popper.min.js"></script>
<script
	src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<title>ì„¤ë¹„ìˆ˜ë¦¬ê´€ë¦¬</title>
<style>
#layoutSidenav_content {
	margin-top: 20px;
}

table {
	width: 100%;
	border-collapse: collapse;
	margin-bottom: 20px;
}

input[type="text"], input[type="date"] {
	width: 200px;
	box-sizing: border-box;
}

label {
	display: block;
	margin-bottom: 5px;
}

input[type="checkbox"] {
	margin-right: 5px;
}

button {
	margin-right: 5px;
}

#myModal3 {
	text-align: center;
}
body {
    font-family: Arial, sans-serif; 
    background-color: #f8f9fa; 
}

.container {
    margin: auto; 
    padding: 20px;
    background-color: #ffffff;
    border-radius: 10px; 
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); 
}

h1 {
    text-align: center;
}

.btn {
    margin-right: 5px;
}

input[type="text"], input[type="date"] {
    width: 100%; 
    padding: 8px; 
    border-radius: 5px; 
    border: 1px solid #ced4da; 
}


#searchInput {
    margin-top: 10px; /* ê²€ìƒ‰ ì…ë ¥ë€ê³¼ ë²„íŠ¼ ì‚¬ì´ì˜ ê°„ê²© ì„¤ì • */
    width: 200px; /* ë„ˆë¹„ë¥¼ ì‘ê²Œ ì¡°ì • */
    padding: 8px; /* ë‚´ë¶€ ì—¬ë°± ì¶”ê°€ */
    border-radius: 5px; /* ì…ë ¥ë€ì— ë¼ìš´ë“œ ëª¨ì„œë¦¬ ì„¤ì • */
    border: 1px solid #ced4da; /* ì…ë ¥ë€ í…Œë‘ë¦¬ ì„¤ì • */
}


.modal-content {
    border-radius: 10px; /* ëª¨ë‹¬ì— ë¼ìš´ë“œ ëª¨ì„œë¦¬ ì„¤ì • */
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* ê·¸ë¦¼ì íš¨ê³¼ ì¶”ê°€ */
}

.modal-header {
    background-color: #007bff; /* ëª¨ë‹¬ í—¤ë” ë°°ê²½ìƒ‰ ì„¤ì • */
    color: white; /* ëª¨ë‹¬ í—¤ë” ê¸€ììƒ‰ ì„¤ì • */
    border-radius: 10px 10px 0 0; /* ëª¨ë‹¬ í—¤ë”ì— ë¼ìš´ë“œ ëª¨ì„œë¦¬ ì„¤ì • */
}

.modal-footer {
    background-color: #f8f9fa; /* ëª¨ë‹¬ í‘¸í„° ë°°ê²½ìƒ‰ ì„¤ì • */
    border-top: none; /* ëª¨ë‹¬ í‘¸í„°ì— í…Œë‘ë¦¬ ì—†ì• ê¸° */
    border-radius: 0 0 10px 10px; /* ëª¨ë‹¬ í‘¸í„°ì— ë¼ìš´ë“œ ëª¨ì„œë¦¬ ì„¤ì • */
}
textarea {
    width: 100%; /* ì „ì²´ ë„ˆë¹„ë¡œ ì„¤ì • */
    padding: 8px; /* ë‚´ë¶€ ì—¬ë°± ì¶”ê°€ */
    border-radius: 5px; /* ë¼ìš´ë“œ ëª¨ì„œë¦¬ ì„¤ì • */
    border: 1px solid #ced4da; /* í…Œë‘ë¦¬ ì„¤ì • */
    resize: none; /* í¬ê¸° ì¡°ì • ë¹„í™œì„±í™” */
    font-family: Arial, sans-serif; /* ê¸€ê¼´ ì„¤ì • */
    font-size: 14px; /* ê¸€ê¼´ í¬ê¸° ì„¤ì • */
    line-height: 1.5; /* ì¤„ ê°„ê²© ì„¤ì • */
}



</style>
</head>
<body>

	<section layout:fragment="content">
		<div class="container">
		<h1>ì„¤ë¹„ìˆ˜ë¦¬ê´€ë¦¬</h1>
			<div id="layoutSidenav_content" class="container text-center">

				<div class="col">
					<br> <br>
					<table class="table">
						<thead>
							<tr>
								<th>ìˆ˜ë¦¬ì½”ë“œ</th>
								<th colspan="2"><input type="text" id="facRepCode"
									name="facRepCode" required readonly></th>
								<th>ì„¤ë¹„ì½”ë“œ</th>
								<th colspan="2"><input type="text" id="facCode"
									name="facCode" required readonly></th>
							</tr>
							<tr>
								<th>ìˆ˜ë¦¬ì‚¬í•­</th>
								<th colspan="2"><input type="text" id="facRepRepairs"
									name="facRepRepairs"></th>
								<th>ì„¤ë¹„ëª…</th>
								<th colspan="2"><input type="text" id="facName"
									name="facName" th:data-facCode="${facCode}" required readonly>
							</tr>
							<tr>
								<th>ë“±ë¡ì¼ì</th>
								<th colspan="2"><input type="date" id="facRepDate"
									name="facRepDate" required></th>
								<th>ë‹´ë‹¹ì</th>
								<th colspan="2"><input type="text" id="facRepPerson"
									name="facRepPerson" th:value="${username}" required></th>
							</tr>
							<tr>
								<th>ìˆ˜ë¦¬ë‚´ìš©</th>
								<td colspan="2"><textarea rows="3" id="facRepContent"
									name="facRepContent" style="resize: none; width: 100%;"></textarea>
								</td>
							</tr>
						</thead>
					</table>
					<input type="hidden" id="facNotCode" name="facNotCode" value="">
					<input type="hidden" id="facNotSituation" name="facNotSituation"
						required>
					<div class="text-center">
						<button type="button" id="saveBtn" class="btn btn-outline-success">ì €ì¥</button>
						<button type="button" id="insertBtn"
							class="btn btn-outline-success">ë“±ë¡</button>
						<button type="button" id="selectBtn"
							class="btn btn-outline-success" data-bs-toggle="modal"
							data-bs-target="#staticBackdropOne">ì¡°íšŒ</button>
						<button type="button" class="btn btn-outline-primary"
						onclick="downloadCSV()">Excel</button>
						<input type="text" id="searchInput" oninput="searchFunction()"
							placeholder="ê²€ìƒ‰...">
					</div>
					<br> <br> <br>
					<div id="grid" class="container"></div>
				</div>
			</div>
		</div>

		<div class="modal" id="staticBackdropOne"
			data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
			aria-labelledby="staticBackdropLabel" aria-hidden="true">
			<div class="modal-dialog modal-dialog-scrollable">
				<!-- modal-dialog í´ë˜ìŠ¤ì— modal-dialog-scrollable í´ë˜ìŠ¤ ì¶”ê°€ -->
				<div class="modal-content">
					<div class="modal-header" style="background-color: #0d6efd;">
						<h1 class="modal-title fs-5" id="staticBackdropLabel"
							style="font-weight: bold"></h1>
						<button type="button" class="btn-close" data-bs-dismiss="modal"
							aria-label="Close"></button>
					</div>
					<div class="modal-body" style="overflow-y: hidden;">
						<!-- overflow-y ì†ì„± ì¶”ê°€ -->
						<table>
							<thead style="text-align: center;">
								<tr>
									<th>ì„¤ë¹„ì½”ë“œ</th>
									<th>ì„¤ë¹„ëª…</th>
									<th>ë¹„ê°€ë™ë“±ë¡ì‚¬ìœ </th>
									<th>ìƒíƒœ</th>
								</tr>
							</thead>

							<tbody style="text-align: center;">
								<tr th:each="NotIns : ${Replist}"
									th:data-facNotCode="${NotIns.facNotCode}"
									th:data-facCode="${NotIns.facCode}"
									th:data-facName="${NotIns.facName}"
									th:data-facNotReason="${NotIns.facNotReason}"
									th:data-facNotSituation="${NotIns.facNotSituation}"
									data-bs-dismiss="modal"
									th:onclick="'displaySelectedFacNotIns(this)'">
									<td th:text="${NotIns.facCode}"></td>
									<td th:text="${NotIns.facName}"></td>
									<td th:text="${NotIns.facNotReason}"></td>
									<td th:text="${NotIns.facNotSituation}"></td>
								</tr>
							</tbody>
						</table>
					</div>
					<div class="modal-footer" style="background-color: #0d6efd;">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">ë‹«ê¸°</button>
					</div>
				</div>
			</div>
		</div>


		<script th:inline="javascript">
		
		function getOutStatus(value, row) {
			console.log(value.value); // ê°’ í™•ì¸ìš© ë¡œê·¸
			let statusText, bgColor;

			// ì£¼ë¬¸ ìƒíƒœì— ë”°ë¼ ì›í•˜ëŠ” ë¬¸ìì—´ê³¼ ë°°ê²½ìƒ‰ ì„¤ì •
			switch (value.value) {
				case "ê°€ë™ëŒ€ê¸°":
					statusText = 'ğŸŸ¡';
					
					break;
				case "ê°€ë™ì¤‘":
					statusText = 'ğŸŸ¢';
					
					break;
				case "ë¹„ê°€ë™":
					statusText = 'ğŸ”´';
					
					break;
				case "":
				case undefined:
				case null:
					statusText = 'ì•Œìˆ˜ ì—†ëŠ” ìƒíƒœ';
					bgColor = 'red'; // ê³„íš ì§„í–‰ì¤‘ì— ëŒ€í•œ ë°°ê²½ìƒ‰ ì„¤ì •
					break;

			}
			return `<div>${statusText}</div>`;
		};
        
		// saveBtn ë²„íŠ¼ì— ì´ë²¤íŠ¸ ê±¸ì–´ì„œ í´ë¦­ ì‹œ í•´ë‹¹ í•¨ìˆ˜ í˜¸ì¶œ
		document.getElementById('saveBtn').addEventListener("click", function() {
		    var facRepRepairs = document.getElementsByName("facRepRepairs")[0].value;

		    // ì…ë ¥í•„ë“œì˜ name ê°’ì„ ê°€ì ¸ì™€ì„œ ê° ë³€ìˆ˜ì— í• ë‹¹
		    var facRepCode = document.getElementsByName("facRepCode")[0].value;
		    var facNotCode = document.getElementsByName("facNotCode")[0].value;
		    var facCode = document.getElementsByName("facCode")[0].value;
		    var facName = document.getElementsByName("facName")[0].value;
		    var facRepPerson = document.getElementsByName("facRepPerson")[0].value;
		    var facRepContent = document.getElementsByName("facRepContent")[0].value;
		    var facRepDate = document.getElementsByName("facRepDate")[0].value;
		    var facNotSituation = document.getElementsByName("facNotSituation")[0].value;
			
		    if (!facName) {
	        	Swal.fire({
	            icon: 'error',
	            text: 'ì„¤ë¹„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'
	        });
	        return;
	    	}
		    
		    if (!facRepRepairs) {
	        	Swal.fire({
	            icon: 'error',
	            text: 'ìˆ˜ë¦¬ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'
	        });
	        return;
	    	}
		    
		    if (!facRepContent) {
	        	Swal.fire({
	            icon: 'error',
	            text: 'ìˆ˜ë¦¬ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'
	        });
	        return;
	    	}
		    
		    // ë“±ë¡í•  ë°ì´í„° ê°ì²´ë¡œ 
		    var data = {
		        facRepCode: facRepCode,
		        facNotCode: facNotCode,
		        facCode: facCode,
		        facName: facName,
		        facRepRepairs: facRepRepairs,
		        facRepPerson: facRepPerson,
		        facRepContent: facRepContent,
		        facRepDate: facRepDate,
		        facNotSituation: facNotSituation
		    };

		    // JSON.stringify() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³€í™˜
		    var jsonData = JSON.stringify(data);
		    
		    // fac_ins update
		    // fetchë¡œ ì„œë²„ì— PUT ìš”ì²­
		    fetch("/updateFacRep", {
		        method: "PUT",
		        body: jsonData, // JSON í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì „ì†¡
		        headers: {
		            "Content-Type": "application/json" // JSON í˜•ì‹ì˜ ë°ì´í„°ì„ì„ ëª…ì‹œ
		        }
		    })
		    .then(response => {
		        console.log(response.status);
		        if (response.ok) {
		        	console.log(response);
    	            Swal.fire({
    	                icon: 'success',
    	                text: 'ë“±ë¡ ì™„ë£Œ!'
    	            }).then(() => {
    	                location.reload(); // ë“±ë¡ ì™„ë£Œ í›„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
    	            });
		        } else {
		        	 console.log(response);
     	            Swal.fire({
     	                icon: 'error',
     	                text: 'ë“±ë¡ ì‹¤íŒ¨'
     	            });
		        }
		    })
		    .catch(error => {
		        console.log(error);
		        alert(ì˜¤ë¥˜);
		    });
		});

        
         
          // insetBtn ë²„íŠ¼ì— ì´ë²¤íŠ¸ ê±¸ì–´ì„œ í´ë¦­ ì‹œ í•´ë‹¹ í•¨ìˆ˜ í˜¸ì¶œ
          document.getElementById('insertBtn').addEventListener("click", function() {
        	    var facRepRepairs = document.getElementsByName("facRepRepairs")[0].value;
        	    
        	 
    	
        	    // ì…ë ¥í•„ë“œì˜ name ê°’ ë°›ì•„ì™€ì„œ ê° ë³€ìˆ˜ì— í• ë‹¹
        	    var facRepCode = document.getElementsByName("facRepCode")[0].value;
        	    var facNotCode = document.getElementsByName("facNotCode")[0].value;
        	    var facCode = document.getElementsByName("facCode")[0].value;
        	    
        	    var facName = document.getElementsByName("facName")[0].value;
        	    var facRepPerson = document.getElementsByName("facRepPerson")[0].value;
        	    var facRepRepairs = document.getElementsByName("facRepRepairs")[0].value;
        	    var facRepContent = document.getElementsByName("facRepContent")[0].value;
        	    var facRepDate = document.getElementsByName("facRepDate")[0].value;
				
        	    if (!facName) {
    	        	Swal.fire({
    	            icon: 'error',
    	            text: 'ì„¤ë¹„ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'
    	        });
    	        return;
    	    	}
    		    
    		    if (!facRepRepairs) {
    	        	Swal.fire({
    	            icon: 'error',
    	            text: 'ìˆ˜ë¦¬ì‚¬í•­ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'
    	        });
    	        return;
    	    	}
    		    
    		    if (!facRepContent) {
    	        	Swal.fire({
    	            icon: 'error',
    	            text: 'ìˆ˜ë¦¬ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'
    	        });
    	        return;
    	    	}
        	    
        	    
        	    // ë“±ë¡í•  ë°ì´í„° ê°ì²´ë¡œ í• ë‹¹
        	    var data = {
        	        facRepCode: facRepCode,
        	        facNotCode: facNotCode,
        	        facCode: facCode,
        	        facName: facName,
        	        facRepRepairs: facRepRepairs,
        	        facRepPerson: facRepPerson,
        	        facRepContent: facRepContent,
        	        facRepDate: facRepDate,
        	    };
        	    console.log(data);
        	    console.log(data.facCode);

        	    // JSON.stringify() í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ JSON í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ë³€í™˜
        	    var jsonData = JSON.stringify(data);
        	    
        	    // ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡í•˜ì—¬ insert ìˆ˜í–‰
        	    fetch("/insertFacRep", {
        	        method: "POST",
        	        body: jsonData, // JSON í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì „ì†¡
        	        headers: {
        	            "Content-Type": "application/json" // JSON í˜•ì‹ì˜ ë°ì´í„°ì„ì„ ëª…ì‹œ
        	        }
        	    })
        	    .then(response => {
        	        console.log(response.status);
        	        if (response.ok) {
        	            console.log(response);
        	            Swal.fire({
        	                icon: 'success',
        	                text: 'ë“±ë¡ ì™„ë£Œ!'
        	            }).then(() => {
        	                location.reload(); // ë“±ë¡ ì™„ë£Œ í›„ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
        	            });
        	        } else {
        	            console.log(response);
        	            Swal.fire({
        	                icon: 'error',
        	                text: 'ë“±ë¡ ì‹¤íŒ¨'
        	            });
        	        }
        	    })
        	    .catch(error => {
        	        console.log(error);
        	        Swal.fire({
        	            icon: 'error',
        	            text: 'ì˜¤ë¥˜ ë°œìƒ'
        	        });
        	    });
        	});
       // ì—…ë°ì´íŠ¸ í›„ í•´ë‹¹ í–‰ì„ ìˆ¨ê¸°ëŠ” í•¨ìˆ˜
          function hideRowAfterUpdate() {
              const facRepCode = document.getElementsByName("facRepCode")[0].value; // ì—…ë°ì´íŠ¸ëœ ìˆ˜ë¦¬ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
              const rows = document.querySelectorAll('#grid tbody tr'); // ë¦¬ìŠ¤íŠ¸ì˜ ê° í–‰ ì„ íƒ

              // ê° í–‰ì„ ìˆœíšŒí•˜ë©´ì„œ ì—…ë°ì´íŠ¸ëœ ìˆ˜ë¦¬ì½”ë“œì™€ ì¼ì¹˜í•˜ëŠ” í–‰ì„ ì°¾ì•„ ìˆ¨ê¸°ê¸°
              rows.forEach(row => {
                  const rowFacRepCode = row.querySelector('td:nth-child(1)').textContent.trim(); // ê° í–‰ì˜ ìˆ˜ë¦¬ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
                  if (rowFacRepCode === facRepCode) { // ì—…ë°ì´íŠ¸ëœ ìˆ˜ë¦¬ì½”ë“œì™€ ì¼ì¹˜í•˜ëŠ” ê²½ìš°
                      row.style.display = 'none'; // í•´ë‹¹ í–‰ ìˆ¨ê¸°ê¸°
                  }
              });
          }

         

         	
        // ê·¸ë¦¬ë“œ í˜ì´ì§•
    
        const grid = new tui.Grid({
            el: document.getElementById('grid'),
            data: [],
            scrollX: false,
            scrollY: false,
            columns: [
                {
                    header: 'ìˆ˜ë¦¬ì½”ë“œ',
                    name: 'facRepCode',
                    align: 'center',
                },
                {
                    header: 'ì„¤ë¹„ëª…',
                    name: 'facName',
                    align: 'center',
                },
                {
                    header: 'ì„¤ë¹„ì½”ë“œ',
                    name: 'facCode',
                    align: 'center',
                },
                {
                    header: 'ìˆ˜ë¦¬ì‚¬í•­',
                    name: 'facRepRepairs',
                    align: 'center'
                },
                {
                    header: 'ë‹´ë‹¹ì',
                    name: 'facRepPerson',
                    align: 'center'
                },
                {
                    header: 'ìˆ˜ë¦¬ë‚´ìš©',
                    name: 'facRepContent',
                    align: 'center'
                },
                {
                    header: 'ë“±ë¡ì¼ì',
                    name: 'facRepDate',
                    formatter :  formatDate,
                    align: 'center'
                },
                {
         	          header: 'ìƒíƒœ',
         	          name: 'facNotSituation',
         	          formatter: getOutStatus,
         	          align: 'center'
         	        }
       
            ],
            rowHeaders: ['rowNum'],
            pageOptions: {
                useClient: true,
                perPage: 5
            }
        });
        
    
         	
     	fetch("/FacRepList")
        .then(response => response.json())
        .then(data => {
            grid.resetData(data); // ê·¸ë¦¬ë“œì— ë°ì´í„°ë¥¼ ì„¤ì •
            console.log("ì—¬ê¸°ê¹Œì§„ ì˜¨ë‹¹!");
        })
        .catch(error => {
            console.error('Error fetching data:', error);
            alert("ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨!");
        });
        
     	
     	
        //  ì°¨ê¸°ì ê²€ì„ ë‚ ì§œí¬ë§·
        function formatDate(dateString) {
        	console.log(dateString);
            // dateStringì„ Date ê°ì²´ë¡œ íŒŒì‹±
            const date = new Date(dateString.value);
            // ë‚ ì§œ í¬ë§· ë³€ê²½
            const formattedDate = date.getFullYear() + '-' + ('0' + (date.getMonth() + 1)).slice(-2) + '-' + ('0' + date.getDate()).slice(-2);
            return formattedDate;
        }
        
     // ì„¤ë¹„ëª… í´ë¦­ ì‹œ ì´ë²¤íŠ¸ ì²˜ë¦¬í•´ì„œ ìœ„ì— input ë°•ìŠ¤ì— ê°’ë„£ê¸°
        function handleFacNameClick(event) {
            // í´ë¦­í•œ í–‰ì˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const rowData = grid.getRowAt(event.rowKey);
			
            // ì„¤ë¹„ëª…ê³¼ ë‹´ë‹¹ì ê°’ì„ ê°€ì ¸ì™€ì„œ input ë°•ìŠ¤ì— ë„£ê¸°
            const facRepCode = rowData.facRepCode;
            const facCode = rowData.facCode;
            const facNotCode = rowData.facNotCode;
            const facName = rowData.facName;
            const facRepPerson = rowData.facRepPerson;
            const facRepRepairs = rowData.facRepRepairs;
            const facRepContent = rowData.facRepContent;
            const facRepDate = rowData.facRepDate;
            const facNotSituation = rowData.facNotSituation;
            
            document.getElementById('facRepCode').value = facRepCode;
            document.getElementById('facCode').value = facCode;
            document.getElementById('facNotCode').value = facNotCode;
            document.getElementById('facName').value = facName;
            document.getElementById('facRepPerson').value = facRepPerson;
            document.getElementById('facRepRepairs').value = facRepRepairs;
            document.getElementById('facRepContent').value = facRepContent;
            document.getElementById('facRepDate').value = facRepDate;
            document.getElementById('facNotSituation').value = facNotSituation;
        }

        // grid ìƒì„± ì½”ë“œ ì•„ë˜ì— ì„¤ë¹„ëª… í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
        grid.on('click', (event) => {
            if (event.columnName === 'facName') {
                handleFacNameClick(event);
            }
        });
		
        
        
        function displaySelectedFacNotIns(element) {
    		var facCode = element.getAttribute('data-facCode');
    		var facNotCode = element.getAttribute('data-facNotCode');
    		var facName = element.getAttribute('data-facName');
    		/* var facNotPerson = element.getAttribute('data-facNotPerson'); */
    		var facNotReason = element.getAttribute('data-facNotReason');
    		var facNotSituation = element.getAttribute('data-facNotSituation');
    		
    		document.getElementById('facCode').value = facCode;
    		document.getElementById('facNotCode').value = facNotCode;
    		document.getElementById('facName').value = facName;
    		/* document.getElementById('facNotPerson').value = facNotPerson; */
    		document.getElementById('facNotReason').value = facNotReason;
    		document.getElementById('facNotSituation').value = facNotSituation;
    	}
        
        
     // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
        function downloadCSV() {
            const gridData = grid.getData(); // ê·¸ë¦¬ë“œì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const header = ['ìˆ˜ë¦¬ì½”ë“œ', 'ì„¤ë¹„ëª…', 'ì„¤ë¹„ì½”ë“œ', 'ìˆ˜ë¦¬ì‚¬í•­', 'ë‹´ë‹¹ì', 'ìˆ˜ë¦¬ë‚´ìš©', 'ë“±ë¡ì¼ì', 'ìƒíƒœ']; // í—¤ë” ìƒì„±
            const csvRows = [header.join(',')]; // í—¤ë”ë¥¼ CSV í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì²« ë²ˆì§¸ í–‰ìœ¼ë¡œ ì„¤ì •

            // ë°ì´í„° ìƒì„±
            gridData.forEach(row => {
                const formattedRow = [];
                formattedRow.push(row.facRepCode);
                formattedRow.push(row.facName);
                formattedRow.push(row.facCode);
                formattedRow.push(row.facRepRepairs);
                formattedRow.push(row.facRepPerson);
                formattedRow.push(row.facRepContent);
                formattedRow.push(row.facRepDate);
                formattedRow.push(row.facNotSituation);
                csvRows.push(formattedRow.join(','));
            });

            // CSV ë‚´ìš© ìƒì„±
            const csvContent = 'data:text/csv;charset=utf-8,' + csvRows.join('\n');
            const encodedUri = encodeURI(csvContent); // URI ì¸ì½”ë”©

            // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„± ë° í´ë¦­
            const link = document.createElement('a');
            link.setAttribute('href', encodedUri);
            link.setAttribute('download', 'data.csv');
            document.body.appendChild(link);
            link.click();
        }

        
        
     	 // ê²€ìƒ‰ ê¸°ëŠ¥ ì¶”ê°€
     	 function searchFunction() {
     	     var input, filter, table, tr, td, i, j, txtValue;
     	     input = document.getElementById("searchInput");
     	     filter = input.value.toUpperCase();
     	     table = document.getElementById("grid");

     	     tr = table.getElementsByTagName("tr");
     	     for (i = 0; i < tr.length; i++) {
     	         td = tr[i].getElementsByTagName("td");
     	         for (j = 0; j < td.length; j++) {
     	             txtValue = td[j].textContent || td[j].innerText;
     	             if (txtValue.toUpperCase().indexOf(filter) > -1) {
     	                 tr[i].style.display = "";
     	                 break;
     	             } else {
     	                 tr[i].style.display = "none";
     	             }
     	         }
     	     }
     	 }
    	
    </script>
	</section>
</body>
</html>
